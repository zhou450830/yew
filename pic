Sub Res宽15cm()
Dim sh As Shape
    For Each sh In ActiveDocument.Shapes
        If sh.Type = msoLinkedPicture Or sh.Type = msoPicture Then
            sh.ConvertToInlineShape
        End If
    Next sh
    ' 自动调整Word文档中的图片大小，并使其水平垂直居中对齐。ResizePictures()遍历所有InlineShape类型图片。如果该图片未锁定纵横比，则将图片宽和高分别乘以0.8缩小为原来的80%。如果该图片已锁定纵横比，则根据其宽高比例进行处理，使得其较短的一侧变为原来的80%。最后，将图片水平居中对齐。
    Dim pic As InlineShape
    For Each pic In ActiveDocument.InlineShapes
        ' 如果该图片未锁定纵横比，则将图片宽高分别缩小为原来的80%
        If Not pic.LockAspectRatio Then
            pic.Height = Application.CentimetersToPoints(15) * pic.Height / pic.Width
            
            pic.Width = Application.CentimetersToPoints(15)
            ' pic.Height = pic.Height * 0.8
            
           ' pic.Width = pic.Width * 0.8
            
        ' 如果图片已经锁定纵横比，则根据其宽高比例进行处理，使得其较短的一侧变为原来的80%
        ElseIf pic.Width > pic.Height Then
           ' pic.Width = pic.Width * 0.8
            pic.Width = Application.CentimetersToPoints(15)
        Else
           ' pic.Width = pic.Width * 0.8
            pic.Width = Application.CentimetersToPoints(15)
        End If
        ' 将该图片水平居中对齐
        pic.Range.ParagraphFormat.SpaceBefore = 0 ' 段前间距设为0
        pic.Range.ParagraphFormat.SpaceAfter = 0 ' 段后间距设为0
        pic.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter
        pic.Range.ParagraphFormat.LineSpacingRule = wdLineSpaceMultiple
        pic.Range.ParagraphFormat.LineSpacing = pic.Height
    Next
End Sub


Sub ResizeAndCenterImag宽页面70缩放()
    
Dim sh As Shape
    For Each sh In ActiveDocument.Shapes
        If sh.Type = msoLinkedPicture Or sh.Type = msoPicture Then
            sh.ConvertToInlineShape
        End If
    Next sh
    ' 自动调整Word文档中的图片大小，并使其水平垂直居中对齐。ResizePictures()遍历所有InlineShape类型图片。如果该图片未锁定纵横比，则将图片宽和高分别乘以0.8缩小为原来的80%。如果该图片已锁定纵横比，则根据其宽高比例进行处理，使得其较短的一侧变为原来的80%。最后，将图片水平居中对齐。
    Dim pic As InlineShape
    For Each pic In ActiveDocument.InlineShapes
        ' 如果该图片未锁定纵横比，则将图片宽高分别缩小为原来的80%
        If Not pic.LockAspectRatio Then
            pic.Height = ActiveDocument.PageSetup.PageWidth * 0.7 * pic.Height / pic.Width
            
            pic.Width = ActiveDocument.PageSetup.PageWidth * 0.7
            ' pic.Height = pic.Height * 0.8
            
           ' pic.Width = pic.Width * 0.8
            
        ' 如果图片已经锁定纵横比，则根据其宽高比例进行处理，使得其较短的一侧变为原来的80%
        ElseIf pic.Width > pic.Height Then
           ' pic.Width = pic.Width * 0.8
            pic.Width = ActiveDocument.PageSetup.PageWidth * 0.7
        Else
           ' pic.Width = pic.Width * 0.8
            pic.Width = ActiveDocument.PageSetup.PageWidth * 0.7
        End If
        ' 将该图片水平居中对齐
        pic.Range.ParagraphFormat.SpaceBefore = 0 ' 段前间距设为0
        pic.Range.ParagraphFormat.SpaceAfter = 0 ' 段后间距设为0
        pic.Range.ParagraphFormat.LineSpacingRule = wdLineSpaceMultiple
        pic.Left = (ActiveDocument.PageSetup.PageWidth - pic.Width) / 2
        pic.Top = (ActiveDocument.PageSetup.PageHeight - pic.Height) / 2
    Next
End Sub



Sub ResizeImag图片80缩放()
    
Dim sh As Shape
    For Each sh In ActiveDocument.Shapes
        If sh.Type = msoLinkedPicture Or sh.Type = msoPicture Then
            sh.ConvertToInlineShape
        End If
    Next sh
    ' 自动调整Word文档中的图片大小，并使其水平垂直居中对齐。ResizePictures()遍历所有InlineShape类型图片。如果该图片未锁定纵横比，则将图片宽和高分别乘以0.8缩小为原来的80%。如果该图片已锁定纵横比，则根据其宽高比例进行处理，使得其较短的一侧变为原来的80%。最后，将图片水平居中对齐。
    Dim pic As InlineShape
    For Each pic In ActiveDocument.InlineShapes
        ' 如果该图片未锁定纵横比，则将图片宽高分别缩小为原来的80%
        If Not pic.LockAspectRatio Then
            
            pic.Height = pic.Height * 0.8
            
            pic.Width = pic.Width * 0.8
            
        ' 如果图片已经锁定纵横比，则根据其宽高比例进行处理，使得其较短的一侧变为原来的80%
        ElseIf pic.Width > pic.Height Then
           pic.Width = pic.Width * 0.8
           
        Else
           pic.Width = pic.Width * 0.8
            
        End If
        ' 将该图片水平居中对齐
        
        pic.Range.ParagraphFormat.SpaceBefore = 0 ' 段前间距设为0
        pic.Range.ParagraphFormat.SpaceAfter = 0 ' 段后间距设为0
        pic.Range.ParagraphFormat.Alignment = wdAlignParagraphCenter
        pic.Range.ParagraphFormat.LineSpacingRule = wdLineSpaceMultiple
        pic.Range.ParagraphFormat.LineSpacing = pic.Height
    Next
End Sub
Sub 完美显示图片0页面视图()
'此宏为雨雪霏霏特别奉献的小偏方，欢迎各位朋友测试。这段VBA代码的作用是使用打印预览来完美显示Word文档中的图片和表格。具体来说，它的执行流程如下：

'切换到页面视图下，使用打印预览功能（ActiveDocument.PrintPreview）

'关闭打印预览（ActiveDocument.ClosePrintPreview）

'切换回常规视图（ActiveWindow.View.Type = wdNormalView）

'再次切换到打印视图（ActiveWindow.View.Type = wdPrintView）

'整个过程的主要目的是利用打印预览的功能刷新Word文档的显示，使其更加精准地呈现出文档中的图片和表格。在这个过程中，文档会从页面视图切换到打印视图，然后再切换回常规视图，这些操作可以有助于强制Word软件重新计算并显示文档内容，从而确保图片和表格排版得到正确的呈现。

'需要注意的是，运行该代码之前需要先选中Word文档中需要处理的部分，如果没有选中则默认处理整个文档。另外，该代码只适用于Word 2007及以后版本。
'如果文档中的各种图片、表格显示迟滞、错位，运行此宏，将在页面视图下完美显示它们。


ActiveDocument.PrintPreview
ActiveDocument.ClosePrintPreview
ActiveWindow.View.Type = wdNormalView
ActiveWindow.View.Type = wdPrintView
End Sub
